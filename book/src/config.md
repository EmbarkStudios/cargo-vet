# Configuration

This section describes the structure and semantics of the various configuration
files used by `cargo vet`.

## Location

By default, `cargo vet` data lives in a `supply-chain` directory next to
`Cargo.lock`. This location is configurable via the `[package.metadata.vet]`
directive in Cargo.toml, as well as via `[workspace.metadata.vet]` when using a
workspace with a virtual root.

The default configuration is equivalent to the following:

```toml
[package.metadata.vet]
store = { path = './supply-chain' }
```

## `audits.toml`

This file contains the audits performed by the project members and descriptions
of the audit criteria. The information in this file can be imported by other
projects.

### `default-criteria`

This key defines the criteria for recorded audits that do not specify the
`criteria` field. The value may be either a string or an array of strings. If
only one set of criteria is defined for the project, this key may be omitted.

### The `criteria` Table

This table maps criteria identifiers to their descriptions. There must be at
least one entry.

### The `audits` Table

This table contains the audit entries, indexed by crate name. Because there are
often multiple audits per crate (different versions, delta audits, etc), audit
entries are specified as table arrays, i.e. `[[audits.foo]]`.

The semantics of the various audit entries keys are described
[here](audit-entries.md).

## `config.toml`

This file contains configuration information for this specific project. This
file cannot be imported by other projects.

### The `imports` Table

This table enumerates the external audit sets that are imported into this
project. The key is a user-defined nickname, so entries are specified as
`[imports.foo]`.

#### `url`

Specifies an HTTPS url from which the remote `audits.toml` can be fetched. This
field is required.

#### `criteria_map`

An inline table or array of inline tables specifying one or more mappings
between the audit criteria of the imported and local sets. Each imported audit
is matched against each mapping. If the imported audit certifies all of the
criteria listed in the `theirs` key, it is associated with the local criteria
specified in the `ours` key. Any imported audits that do not match any mappings
are discarded.

### the `policy` Table

By default, invoking `cargo vet` will recursively check every top-level crate in
the workspace against the default criteria for all possible platforms. These
defaults can be overridden as needed with entries in the `policy` table. The
table is indexed by top-level crate name, and each entry has the following
fields.

#### `criteria`

A string or array of strings specifying the criteria that should be enforced for
this crate and its dependency tree.

Defaults to the `default-criteria` in `audits.toml`.

#### `build-and-dev-criteria`

Same as the above, but applied to build-dependencies and dev-dependencies.

Defaults to the same value as `criteria`.

#### `targets`

A string or array of target specifiers for the platforms of interest for this
top-level crate. These are the platforms that `cargo vet` will require audits
for when traversing the subtree (audits can optionally [restrict their
validity](audit-entries.md#targets) to a set of targets).

Defaults to all platforms.

#### `build-and-dev-targets`

Same as the above, but applied to build-dependencies and dev-dependencies.

Defaults to the same value as `targets`.

### The `unaudited` Table

This table enumerates the set of crates which are being used despite missing the
required audits. It has a similar structure to the `audits` table in
`audits.toml`, but each entry has fewer supported fields.

#### `version`

Specifies the exact version which should be exempted.

#### `notes`

Free-form string for recording rationale or other relevant information.

## `imports.lock`

This file is auto-generated by `cargo vet` and its format should be treated as
an implementation detail.
